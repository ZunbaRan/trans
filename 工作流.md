éœ€è¦æ–°å¢çš„åŠŸèƒ½æ¦‚æ‹¬
æˆ‘æ¥å¸®ä½ æ•´åˆè¿™ä¸¤ä»½å·¥ä½œæµçš„ä¼˜ç‚¹ï¼Œè®¾è®¡ä¸€ä¸ªæ›´å®Œæ•´çš„åˆ†ææ¡†æ¶ã€‚

# æ•´åˆåçš„æ’­å®¢æ–‡å­—ç¨¿åˆ†æå·¥ä½œæµ

## ç¬¬ä¸€é˜¶æ®µï¼šæ™ºèƒ½åˆ†æ®µä¸ä¸»é¢˜è¯†åˆ«
ç›®æ ‡ï¼šå®ç°å†…å®¹çš„åˆæ­¥ç»“æ„åŒ–æ‹†è§£

æç¤ºè¯ï¼š
```
ä½œä¸ºä¸“ä¸šå†…å®¹åˆ†æå¸ˆï¼Œè¯·æŒ‰ä»¥ä¸‹æ­¥éª¤åˆ†ææ’­å®¢æ–‡å­—ç¨¿ï¼š

1. è¯†åˆ«å†…å®¹è½¬æŠ˜æ ‡å¿—ï¼š
- æ˜æ˜¾çš„è¿‡æ¸¡å¥ï¼ˆå¦‚"æ¥ä¸‹æ¥è®¨è®º..."ï¼‰
- è¯é¢˜åˆ‡æ¢çš„è¯­è¨€æ ‡è®°
- æ—¶é—´æˆ³è®°å½•ï¼ˆå¦‚æœ‰ï¼‰

2. åˆ’åˆ†ä¸»é¢˜æ®µè½ï¼š
- ä¸ºæ¯ä¸ªæ®µè½æ ‡æ³¨ä½ç½®èŒƒå›´
- æç‚¼2-5å­—çš„ä¸»é¢˜æ ‡ç­¾
- æ¦‚æ‹¬è¯¥éƒ¨åˆ†æ ¸å¿ƒè¦ç‚¹

è¾“å‡ºæ ¼å¼ï¼š
[æ®µè½1]
ä¸»é¢˜ï¼š<ç®€æ˜æ ‡ç­¾>
ä½ç½®ï¼šç¬¬X-Yæ®µ
æ ¸å¿ƒè¦ç‚¹ï¼š
- è¦ç‚¹1
- è¦ç‚¹2
èµ·å§‹æ ‡å¿—ï¼š<è¿‡æ¸¡å¥/èµ·å§‹å¥>
```

## ç¬¬äºŒé˜¶æ®µï¼šæ·±åº¦å†…å®¹è§£æ
ç›®æ ‡ï¼šå¤šç»´åº¦æå–å†…å®¹è¦ç´ 

æç¤ºè¯ï¼š
```
è¯·å¯¹æ¯ä¸ªä¸»é¢˜æ®µè½è¿›è¡Œæ·±å…¥åˆ†æï¼š

1. è®ºç‚¹æå–ï¼š
- åˆ—å‡ºå…³é”®è®ºç‚¹
- æ ‡æ³¨è®ºç‚¹é—´çš„é€»è¾‘å…³ç³»ï¼ˆå¹¶åˆ—/é€’è¿›/å› æœï¼‰
- æå–æ”¯æŒè®ºç‚¹çš„ä½è¯ææ–™

2. æ¡ˆä¾‹è¯†åˆ«ï¼š
- æ ‡æ³¨[æ¡ˆä¾‹]å¹¶åˆ†ç±»ï¼ˆè¡Œä¸šæ¡ˆä¾‹/ä¸ªäººç»å†/å†å²å…¸æ•…ï¼‰
- è¯´æ˜æ¡ˆä¾‹åœ¨è®ºè¯ä¸­çš„ä½œç”¨

3. é‡‘å¥æŒ–æ˜ï¼š
æ ‡è®°[é‡‘å¥]å¹¶æ³¨æ˜ç±»å‹ï¼š
- æ´å¯Ÿå‹ï¼šæä¾›ç‹¬ç‰¹è§è§£
- è®ºè¯å‹ï¼šæœ‰åŠ›è®ºè¯
- æ€»ç»“å‹ï¼šç²¾ç‚¼æ¦‚æ‹¬
- ä¿®è¾å‹ï¼šæ¯”å–»æˆ–ä¿®è¾ä¼˜ç¾

æ¯ä¸ªé‡‘å¥è¯´æ˜ï¼š
- åŸæ–‡
- ç±»å‹
- åœ¨å†…å®¹ä¸­çš„ä½œç”¨
- æƒ…æ„Ÿå¼ºåº¦ï¼ˆğŸ”¥Ã—1-3ï¼‰
```

## ç¬¬ä¸‰é˜¶æ®µï¼šç»“æ„åŒ–è¾“å‡º
ç›®æ ‡ï¼šç”Ÿæˆæ¸…æ™°çš„æ€ç»´å¯¼å›¾ç»“æ„

```markdown
è¯·å°†åˆ†æç»“æœè½¬æ¢ä¸ºç»“æ„åŒ–æ€ç»´å¯¼å›¾ï¼š

1. å±‚çº§ç»“æ„ï¼š
æ ¸å¿ƒä¸»é¢˜
â”œâ”€â”€ æ®µè½ä¸»é¢˜1 [æ—¶é—´æˆ³]
â”‚   â”œâ”€â”€ æ ¸å¿ƒè®ºç‚¹
â”‚   â”‚   â”œâ”€â”€ ä½è¯ææ–™
â”‚   â”‚   â””â”€â”€ æ¡ˆä¾‹åˆ†æ
â”‚   â””â”€â”€ é‡‘å¥ï¼ˆå¸¦ç±»å‹æ ‡æ³¨å’Œæƒ…æ„Ÿå¼ºåº¦ï¼‰
â””â”€â”€ æ®µè½ä¸»é¢˜2
    ...

2. ç‰¹æ®Šæ ‡æ³¨ï¼š
- ä½¿ç”¨emojiåŒºåˆ†ä¸åŒç±»å‹å†…å®¹
- æ ‡æ³¨è®ºç‚¹é—´çš„é€»è¾‘å…³ç³»
- ä¿ç•™æ—¶é—´æˆ³ä¿¡æ¯
```

## å·¥ä½œæµä¼˜åŒ–å»ºè®®ï¼š

1. åˆ†å—å¤„ç†æœºåˆ¶
- å¯¹è¶…é•¿å†…å®¹å…ˆåˆ†å—å¤„ç†
- è®¾ç½®åˆç†çš„å¤„ç†å•å…ƒå¤§å°ï¼ˆå»ºè®®2000-3000å­—ï¼‰
- ä¿è¯å„å—ä¹‹é—´çš„é€»è¾‘è¿è´¯

è¶…é•¿å†…å®¹çš„åˆ†å—å¤„ç†ç­–ç•¥ï¼š

# é•¿æ–‡æœ¬åˆ†å—å¤„ç†æ–¹æ¡ˆ

## ä¸€ã€åˆ†å—åŸåˆ™

1. **å¤§å°æ§åˆ¶**
- å»ºè®®æ¯å— 2000-3000 å­—
- ä¿æŒå®Œæ•´æ®µè½ï¼Œä¸åœ¨æ®µè½ä¸­é—´æˆªæ–­
- è€ƒè™‘è‡ªç„¶è¯é¢˜è¾¹ç•Œ

2. **é‡å ç­–ç•¥**
- æ¯å—ä¸å‰åå—ä¿æŒ 200-300 å­—çš„é‡å 
- é‡å éƒ¨åˆ†åŒ…å«å®Œæ•´æ®µè½
- ç¡®ä¿ä¸Šä¸‹æ–‡è¿è´¯æ€§

## äºŒã€å…·ä½“å®æ–½æ­¥éª¤

```markdown
Step 1: åˆå§‹åˆ†å—
æç¤ºè¯ï¼š
"""
è¯·å¸®æˆ‘å¯¹ä»¥ä¸‹é•¿æ–‡æœ¬è¿›è¡Œåˆæ­¥åˆ†å—ï¼š
1. è¯†åˆ«è‡ªç„¶æ®µè½è¾¹ç•Œ
2. æ ‡æ³¨æ˜æ˜¾çš„è¯é¢˜è½¬æ¢ç‚¹
3. æŒ‰ç…§2000-3000å­—çš„è§„æ¨¡åˆ’åˆ†å—
4. ç¡®ä¿æ¯ä¸ªåˆ†å—éƒ½æ˜¯å®Œæ•´çš„è¯­ä¹‰å•å…ƒ

è¾“å‡ºæ ¼å¼ï¼š
Block 1:
- èµ·å§‹ä½ç½®ï¼š[ç¬¬ä¸€å¥è¯çš„å‰10ä¸ªå­—]
- ç»“æŸä½ç½®ï¼š[æœ€åä¸€å¥è¯çš„å‰10ä¸ªå­—]
- é¢„ä¼°å­—æ•°ï¼šxxxå­—
- ä¸»è¦è¯é¢˜ï¼šxxx
- é‡å éƒ¨åˆ†æ ‡æ³¨ï¼š[ä¸ä¸‹ä¸€å—é‡å çš„æ®µè½]

Block 2:
...
"""

Step 2: é‡å å¤„ç†
æç¤ºè¯ï¼š
"""
è¯·æ£€æŸ¥ç›¸é‚»åˆ†å—ä¹‹é—´çš„è¿æ¥å¤„ï¼š
1. ç¡®è®¤é‡å æ®µè½çš„å®Œæ•´æ€§
2. æ£€æŸ¥ä¸Šä¸‹æ–‡è¿è´¯æ€§
3. æ ‡æ³¨å…³é”®çš„æ‰¿ä¸Šå¯ä¸‹ä¿¡æ¯

è¾“å‡ºï¼š
Block 1 â†’ Block 2 è¿æ¥å¤„ï¼š
- é‡å æ®µè½ï¼š[å…·ä½“å†…å®¹]
- å…³é”®è¿æ¥è¯/å¥ï¼š[...]
- ä¸Šä¸‹æ–‡å…³ç³»ï¼š[...]
"""
```

## ä¸‰ã€åˆ†å—åçš„å¤„ç†æµç¨‹

1. **å¹¶è¡Œå¤„ç†**
```typescript
for block in blocks:
    # å¯¹æ¯ä¸ªå—è¿›è¡Œä¸»é¢˜åˆ†æ
    themes = analyze_themes(block)
    
    # è®°å½•å—é—´å…³ç³»
    block_relations = {
        'previous': overlapping_content_with_previous,
        'next': overlapping_content_with_next,
        'key_connections': connecting_points
    }
```

2. **ç»“æœæ•´åˆ**
```markdown
æç¤ºè¯ï¼š
"""
è¯·å°†å¤šä¸ªåˆ†å—çš„åˆ†æç»“æœæ•´åˆï¼š
1. è¯†åˆ«é‡å¤å‡ºç°çš„ä¸»é¢˜
2. åˆå¹¶ç›¸å…³çš„è®ºç‚¹å’Œè¯æ®
3. å»ºç«‹è·¨å—çš„é€»è¾‘å…³è”
4. ç”Ÿæˆæ•´ä½“æ€§æ‘˜è¦

æ³¨æ„ï¼š
- å»é™¤é‡å éƒ¨åˆ†çš„é‡å¤ä¿¡æ¯
- ä¿æŒè®ºè¿°çš„è¿è´¯æ€§
- çªå‡ºæ ¸å¿ƒä¸»é¢˜çš„å»¶ç»­æ€§
"""
```

## å››ã€å®ä¾‹æ¼”ç¤º

```markdown
åŸæ–‡ï¼š[10000å­—é•¿æ–‡]

â†“ åˆ†å—å¤„ç†

Block 1 (0-2500å­—)ï¼š
ä¸»é¢˜ï¼šå¼€åœºä¸èƒŒæ™¯ä»‹ç»
é‡å æ®µè½ï¼šç¬¬8æ®µï¼ˆè½¬æŠ˜æ®µè½ï¼‰

Block 2 (2300-4800å­—)ï¼š
ä¸»é¢˜ï¼šæ ¸å¿ƒè®ºè¿°ç¬¬ä¸€éƒ¨åˆ†
é‡å æ®µè½ï¼šå‰æœ‰ç¬¬8æ®µï¼Œåæœ‰ç¬¬15æ®µ

Block 3 (4600-7000å­—)ï¼š
...

â†“ æ•´åˆåˆ†æ

æœ€ç»ˆè¾“å‡ºï¼š
1. æ•´ä½“ç»“æ„å›¾
2. åˆ†å—é—´çš„å…³ç³»å›¾
3. ä¸»é¢˜æ¼”è¿›è„‰ç»œ
4. å®Œæ•´çš„æ€ç»´å¯¼å›¾
```

## å…­ã€æ³¨æ„äº‹é¡¹

1. **åˆ†å—æ—¶æœº**
- åœ¨è¿›è¡Œè¯¦ç»†åˆ†æä¹‹å‰å®Œæˆåˆ†å—
- é¢„ç•™å……è¶³çš„é‡å éƒ¨åˆ†
- è®°å½•åˆ†å—çš„ä¾æ®å’ŒåŸåˆ™

2. **æ•´åˆç­–ç•¥**
- é‡‡ç”¨è‡ªåº•å‘ä¸Šçš„æ•´åˆæ–¹æ³•
- ä¿æŒå„å—åˆ†æçš„ä¸€è‡´æ€§
- æ³¨æ„ä¸»é¢˜çš„å»¶ç»­æ€§

3. **çµæ´»è°ƒæ•´**
- æ ¹æ®å†…å®¹å¤æ‚åº¦è°ƒæ•´å—å¤§å°
- ç‰¹æ®Šè¯é¢˜å¯èƒ½éœ€è¦æ›´å¤šé‡å 
- å…è®¸éå‡åŒ€åˆ†å—

é€šè¿‡è¿™æ ·çš„åˆ†å—å¤„ç†ï¼Œå¯ä»¥ï¼š
1. æé«˜å¤„ç†æ•ˆç‡
2. ä¿è¯åˆ†æè´¨é‡
3. ä¾¿äºå¹¶è¡Œå¤„ç†
4. ç¡®ä¿ç»“æœçš„å®Œæ•´æ€§å’Œè¿è´¯æ€§


ç®€æ˜“ä»£ç æ¡†æ¶

## 1. æ ¸å¿ƒç±»å‹å®šä¹‰

```typescript
// types/block.types.ts
export interface TextBlock {
  content: string;
  startPosition: number;
  endPosition: number;
  overlapPrevious: string;
  overlapNext: string;
  mainTopic: string;
  wordCount: number;
}

// types/analysis.types.ts
export interface Theme {
  title: string;
  position: {
    start: number;
    end: number;
  };
  keyPoints: string[];
}

export interface Quote {
  content: string;
  type: 'insight' | 'argument' | 'summary' | 'rhetoric';
  emotionIntensity: 1 | 2 | 3;
  position: number;
}

export interface AnalysisResult {
  themes: Theme[];
  arguments: Argument[];
  quotes: Quote[];
  cases: Case[];
  relations: Record<string, any>;
}

// types/mindmap.types.ts
export interface MindMapNode {
  id: string;
  content: string;
  type: 'theme' | 'argument' | 'quote' | 'case';
  children?: MindMapNode[];
  metadata?: Record<string, any>;
}
```

## 2. æ ¸å¿ƒæœåŠ¡å®ç°

```typescript
// services/AIService.ts
import { Configuration, OpenAIApi } from 'openai';

export class AIService {
  private client: OpenAIApi;

  constructor(apiKey: string) {
    const configuration = new Configuration({ apiKey });
    this.client = new OpenAIApi(configuration);
  }

  async getCompletion(prompt: string): Promise<string> {
    try {
      const response = await this.client.createCompletion({
        model: 'text-davinci-003',
        prompt,
        max_tokens: 1000,
      });
      return response.data.choices[0].text || '';
    } catch (error) {
      console.error('AI Service Error:', error);
      throw error;
    }
  }
}

// services/TextSplitter.ts
export class TextSplitter {
  constructor(private config: { blockSize: number; overlapSize: number }) {}

  async splitText(text: string): Promise<TextBlock[]> {
    // å®ç°æ–‡æœ¬åˆ†å—é€»è¾‘
    const blocks: TextBlock[] = [];
    // ...
    return blocks;
  }

  private validateBlock(block: TextBlock): boolean {
    // å®ç°éªŒè¯é€»è¾‘
    return true;
  }
}

// services/ContentAnalyzer.ts
export class ContentAnalyzer {
  constructor(private aiService: AIService) {}

  async analyzeBlock(block: TextBlock): Promise<AnalysisResult> {
    // å®ç°åˆ†æé€»è¾‘
    return {
      themes: [],
      arguments: [],
      quotes: [],
      cases: [],
      relations: {},
    };
  }
}
```

## 3. ä¸»æ§åˆ¶å™¨

```typescript
// PodcastAnalyzer.ts
export class PodcastAnalyzer {
  constructor(
    private textSplitter: TextSplitter,
    private contentAnalyzer: ContentAnalyzer,
    private config: Config
  ) {}

  async analyzePodcast(transcript: string): Promise<{
    analysis: AnalysisResult;
    mindMap: MindMapNode;
  }> {
    try {
      // 1. åˆ†å—
      const blocks = await this.textSplitter.splitText(transcript);

      // 2. å¹¶è¡Œåˆ†æ
      const blockResults = await Promise.all(
        blocks.map(block => this.contentAnalyzer.analyzeBlock(block))
      );

      // 3. åˆå¹¶ç»“æœ
      const finalResult = await this.mergeResults(blockResults);

      // 4. ç”Ÿæˆæ€ç»´å¯¼å›¾
      const mindMap = await this.generateMindMap(finalResult);

      return {
        analysis: finalResult,
        mindMap,
      };
    } catch (error) {
      console.error('Analysis Error:', error);
      throw error;
    }
  }

  private async mergeResults(results: AnalysisResult[]): Promise<AnalysisResult> {
    // å®ç°ç»“æœåˆå¹¶é€»è¾‘
    return results[0]; // ä¸´æ—¶è¿”å›
  }

  private async generateMindMap(result: AnalysisResult): Promise<MindMapNode> {
    // å®ç°æ€ç»´å¯¼å›¾ç”Ÿæˆé€»è¾‘
    return {
      id: '1',
      content: 'Root',
      type: 'theme',
      children: [],
    };
  }
}
```

## 4. é…ç½®ç®¡ç†

```typescript
// config/default.ts
export interface Config {
  ai: {
    model: string;
    maxTokens: number;
    temperature: number;
  };
  textSplitter: {
    blockSize: number;
    overlapSize: number;
  };
  analysis: {
    themeMinLength: number;
    themeMaxLength: number;
    quoteMinLength: number;
    quoteMaxLength: number;
  };
}

export const defaultConfig: Config = {
  ai: {
    model: 'text-davinci-003',
    maxTokens: 4096,
    temperature: 0.7,
  },
  textSplitter: {
    blockSize: 2500,
    overlapSize: 250,
  },
  analysis: {
    themeMinLength: 2,
    themeMaxLength: 5,
    quoteMinLength: 10,
    quoteMaxLength: 100,
  },
};
```

## 5. ä½¿ç”¨ç¤ºä¾‹

```typescript
// index.ts
import { PodcastAnalyzer } from './PodcastAnalyzer';
import { TextSplitter } from './services/TextSplitter';
import { ContentAnalyzer } from './services/ContentAnalyzer';
import { AIService } from './services/AIService';
import { defaultConfig } from './config/default';

async function main() {
  // åˆå§‹åŒ–æœåŠ¡
  const aiService = new AIService(process.env.OPENAI_API_KEY!);
  const textSplitter = new TextSplitter(defaultConfig.textSplitter);
  const contentAnalyzer = new ContentAnalyzer(aiService);

  // åˆ›å»ºåˆ†æå™¨
  const analyzer = new PodcastAnalyzer(
    textSplitter,
    contentAnalyzer,
    defaultConfig
  );

  try {
    // è¯»å–æ–‡ä»¶
    const transcript = await```typescript
    const transcript = await fs.readFile('podcast.txt', 'utf-8');

    // æ‰§è¡Œåˆ†æ
    const { analysis, mindMap } = await analyzer.analyzePodcast(transcript);

    // å¯¼å‡ºç»“æœ
    await fs.writeFile('analysis.json', JSON.stringify(analysis, null, 2));
    await fs.writeFile('mindmap.json', JSON.stringify(mindMap, null, 2));
  } catch (error) {
    console.error('Error:', error);
    process.exit(1);
  }
}

main();
```

## 6. å¼€å‘å»ºè®®

1. **å¾ªåºæ¸è¿›**
   - å…ˆå®Œæˆæ–‡æœ¬åˆ†å—åŠŸèƒ½
   - å®ç°åŸºç¡€çš„ AI æœåŠ¡é›†æˆ
   - æ·»åŠ å†…å®¹åˆ†æåŠŸèƒ½
   - æœ€åå®ç°æ€ç»´å¯¼å›¾ç”Ÿæˆ

2. **é”™è¯¯å¤„ç†**
   - ä½¿ç”¨è‡ªå®šä¹‰é”™è¯¯ç±»
   - å®ç°é‡è¯•æœºåˆ¶
   - æ·»åŠ è¯¦ç»†æ—¥å¿—

3. **æ€§èƒ½ä¼˜åŒ–**
   - ä½¿ç”¨ Worker Threads å¤„ç†å¹¶è¡Œä»»åŠ¡
   - å®ç°è¯·æ±‚é˜Ÿåˆ—å’Œé™æµ
   - æ·»åŠ ç¼“å­˜å±‚
